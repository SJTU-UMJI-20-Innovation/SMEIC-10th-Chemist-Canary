<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="Assets/material-icons.css">
    <link rel="stylesheet" href="material-design-lite_custom.css">
    <link rel="stylesheet" href="Assets/material-main.css">
    <script src="Assets/polyfill-min.js">
    </script>
    <script src="sub/http-live-player.js">
    </script>
    <script src="button.js">
    </script>
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        svg: {
          fontCache: 'global'
        }
      };
    </script>
    <script id="MathJax-script" async src="Assets/tex-svg.js">
    </script>
    <script src="main.js">
    </script>
    <script defer src="Assets/material-minimal.js">
    </script>
    <title>Chemist
    </title>
  </head>
  <body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-drawer
                mdl-layout--fixed-header">
      <header class="mdl-layout__header">
        <div class="mdl-layout__header-row">
          <span id="main-title" class="mdl-layout-title">Chemist
          </span>
          <div class="mdl-layout-spacer">
          </div>
          <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable
                      mdl-textfield--floating-label mdl-textfield--align-right">
            <label class="mdl-button mdl-js-button mdl-button--icon" for="fixed-header-drawer-exp">
              <i class="material-icons">search
              </i>
            </label>
            <div class="mdl-textfield__expandable-holder">
              <input class="mdl-textfield__input" type="text" name="sample" id="fixed-header-drawer-exp">
            </div>
          </div>
        </div>
      </header>
      
      <div class="mdl-layout__drawer">
        <span class="mdl-layout-title">Chemist
        </span>
        <nav class="mdl-navigation">
          <a class="mdl-navigation__link" id="SIDEBAR_ITEM_demonstration">Demonstration
          </a>
          <a class="mdl-navigation__link" id="SIDEBAR_ITEM_scripting">Command-line
          </a>
          </a>
        </nav>
      </div>
      <main class="mdl-layout__content">
        <div class="page-content">
          <div id="WRAPPER">
            <div id="DISPLAY" style="width:60%">
              <canvas id="CAMERA" style="width:100%">
              </canvas>
            </div>
            <div id="CONTROL" style="height:100%">
              <!-- Snackbar -->
              <div id="demo-toast-example" class="mdl-js-snackbar mdl-snackbar">
                <div class="mdl-snackbar__text">
                </div>
                <button class="mdl-snackbar__action" type="button">
                </button>
              </div>
              <!-- Main -->
              <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header mdl-layout--fixed-tabs" id="CONTROL_TABS">
                <header class="mdl-layout__header">
                  <div class="mdl-layout__tab-bar mdl-js-ripple-effect">
                    <a href="#fixed-tab-1" class="mdl-layout__tab is-active">Environment
                    </a>
                    <a href="#fixed-tab-2" class="mdl-layout__tab">Left Arm
                    </a>
                    <a href="#fixed-tab-3" class="mdl-layout__tab">Right Arm
                    </a>
                  </div>
                </header>
                <main class="mdl-layout__content" style="padding:10px">
                  <section class="mdl-layout__tab-panel is-active" id="fixed-tab-1">
                    <div class="page-content">
                      <!-- PAGE CONTENT 1 BEGIN -->
                      <!-- Welcome -->
                      <div class="demo-card-wide mdl-card mdl-shadow--2dp">
                        <div class="mdl-card__title">
                          <h2 class="mdl-card__title-text">Welcome!
                          </h2>
                        </div>
                        <div class="mdl-card__supporting-text">
                          First time here? Are you ready to conduct your first experiment?
                        </div>
                        <div class="mdl-card__actions mdl-card--border">
                          <a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" onclick=promptDemonstrationExperiment()>
                            Get Started
                          </a>
                        </div>
                        <div class="mdl-card__menu">
                          <button class="mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect">
                            <i class="material-icons">share
                            </i>
                          </button>
                        </div>
                      </div>
                      <!-- ACTIONS BEGIN -->
                      <ul class="demo-list-two mdl-list">
                        <!-- ACTION: RESET -->
                        <li class="mdl-list__item mdl-list__item--two-line">
                          <span class="mdl-list__item-primary-content">
                            <span>Reset
                            </span>
                            <span class="mdl-list__item-sub-title">Reset whole environment
                            </span>
                          </span>
                          <span class="mdl-list__item-secondary-action">
                            <button class="mdl-button mdl-js-ripple-effect mdl-js-button mdl-button--raised mdl-button--accent" onclick=OnClick.Environment.Reset()>
                            Reset
                            </button>
                          </span>
                        </li>
                        <!-- ACTION: WORKSTATE -->
                        <li class="mdl-list__item mdl-list__item--two-line">
                          <span class="mdl-list__item-primary-content">
                            <span>Set working state
                            </span>
                            <span class="mdl-list__item-sub-title">I do not know how to write a description
                            </span>
                          </span>
                          <span class="mdl-list__item-secondary-action">
                            <label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="SWITCH-workstate">
                              <input type="checkbox" id="SWITCH-workstate" class="mdl-switch__input" onclick=OnClick.Environment.SwitchWorkstate()>
                            </label>
                          </span>
                        </li>
                      </ul>
                      <!-- ACTIONS END -->
                      <!-- PAGE CONTENT 1 END -->
                    </div>
                  </section>
                  <section class="mdl-layout__tab-panel" id="fixed-tab-2">
                    <div class="page-content">
                      <!-- ACTIONS BEGIN -->
                      <!-- ACTION: HOLD -->
                      <ul class="demo-list-two mdl-list">
                        <li class="mdl-list__item mdl-list__item--two-line">
                          <span class="mdl-list__item-primary-content">
                            <span>Hold
                            </span>
                            <span class="mdl-list__item-sub-title">Take hold of a container
                            </span>
                          </span>
                          <span class="mdl-list__item-secondary-action">
                            <button id="menu-leftarm-hold" class="mdl-button mdl-js-button mdl-button--icon">
                              <i class="material-icons">more_vert
                            </i>
                            </button>
                          </span>
                          <ul class="mdl-menu mdl-js-menu mdl-menu--bottom-right mdl-js-ripple-effect" for="menu-leftarm-hold">
                            <li class="mdl-menu__item" onclick=OnClick.LeftArm.Hold('tube')>Tube
                            </li>
                            <li class="mdl-menu__item" onclick=OnClick.LeftArm.Hold('beaker')>Beaker
                            </li>
                            <li class="mdl-menu__item" onclick=OnClick.LeftArm.Hold('flask')>Flask
                            </li>
                          </ul>
                        </li>
                      <!-- ACTION: ACQUIRE -->
                        <li class="mdl-list__item mdl-list__item--two-line">
                          <span class="mdl-list__item-primary-content">
                            <span>Acquire
                            </span>
                            <span class="mdl-list__item-sub-title" id="leftarm-acquire-quantity-display">Amount: Little
                            </span>
                          </span>
                          <span class="mdl-list__item-secondary-action">
                            <button id="leftarm-acquire-menu-button" class="mdl-button mdl-js-button mdl-button--icon" onclick=OnClick.LeftArm.GetChemicals()>
                              <i class="material-icons">add
                              </i>
                            </button>
                          </span>
                          <ul class="mdl-menu mdl-js-menu mdl-menu--bottom-right mdl-js-ripple-effect" for="leftarm-acquire-menu-button">
                            <li id="leftarm-acquire-menu-1" class="mdl-menu__item" onclick=OnClick.LeftArm.Acquire(1)>
                            </li>
                            <li id="leftarm-acquire-menu-2" class="mdl-menu__item" onclick=OnClick.LeftArm.Acquire(2)>
                            </li>
                            <li id="leftarm-acquire-menu-3" class="mdl-menu__item" onclick=OnClick.LeftArm.Acquire(3)>
                            </li>
                            <li id="leftarm-acquire-menu-4" class="mdl-menu__item" onclick=OnClick.LeftArm.Acquire(4)>
                            </li>
                          </ul>
                        </li>
                        <input class="mdl-slider mdl-js-slider" id="leftarm-acquire-quantity-slider" type="range" min="0" max="3" value="1" onchange=OnClick.LeftArm.AcquireQuantityUpdate()>
                      </ul>
                      <!-- ACTION: MIX -->
                      <li class="mdl-list__item mdl-list__item--two-line">
                        <span class="mdl-list__item-primary-content">
                          <span>Mix to right arm
                          </span>
                          <span class="mdl-list__item-sub-title">Tilt the container to mix with right arm
                          </span>
                        </span>
                        <span class="mdl-list__item-secondary-action">
                          <button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--colored" onclick=OnClick.LeftArm.Mix()>
                            Mix
                          </button>
                        </span>
                      </li>
                      <!-- ACTION: OBSERVE -->
                      <li class="mdl-list__item mdl-list__item--two-line">
                        <span class="mdl-list__item-primary-content">
                          <span>Observe
                          </span>
                          <span class="mdl-list__item-sub-title">Use HD Camera to observe left arm
                          </span>
                        </span>
                        <span class="mdl-list__item-secondary-action">
                          <button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--colored" onclick=OnClick.LeftArm.Mix()>
                            Observe
                          </button>
                        </span>
                      </li>
                      <!-- ACTIONS END -->
                    </div>
                  </section>
                  <section class="mdl-layout__tab-panel" id="fixed-tab-3">
                    <div class="page-content">
                      <!-- ACTIONS BEGIN -->
                      <!-- ACTION: HOLD -->
                      <ul class="demo-list-two mdl-list">
                        <li class="mdl-list__item mdl-list__item--two-line">
                          <span class="mdl-list__item-primary-content">
                            <span>Hold
                            </span>
                            <span class="mdl-list__item-sub-title">Take hold of a container
                            </span>
                          </span>
                          <span class="mdl-list__item-secondary-action">
                            <button id="menu-rightarm-hold" class="mdl-button mdl-js-button mdl-button--icon">
                              <i class="material-icons">more_vert
                            </i>
                            </button>
                          </span>
                          <ul class="mdl-menu mdl-js-menu mdl-menu--bottom-right mdl-js-ripple-effect" for="menu-rightarm-hold">
                            <li class="mdl-menu__item" onclick=OnClick.RightArm.Hold('tube')>Tube
                            </li>
                            <li class="mdl-menu__item" onclick=OnClick.RightArm.Hold('beaker')>Beaker
                            </li>
                            <li class="mdl-menu__item" onclick=OnClick.RightArm.Hold('flask')>Flask
                            </li>
                          </ul>
                        </li>
                      <!-- ACTION: ACQUIRE -->
                        <li class="mdl-list__item mdl-list__item--two-line">
                          <span class="mdl-list__item-primary-content">
                            <span>Acquire
                              </span>
                            <span class="mdl-list__item-sub-title" id="rightarm-acquire-quantity-display">Amount: Little
                            </span>
                          </span>
                          <span class="mdl-list__item-secondary-action">
                            <button id="rightarm-acquire-menu-button" class="mdl-button mdl-js-button mdl-button--icon" onclick=OnClick.RightArm.GetChemicals()>
                              <i class="material-icons">add
                            </i>
                            </button>
                          </span>
                          <ul class="mdl-menu mdl-js-menu mdl-menu--bottom-right mdl-js-ripple-effect" for="rightarm-acquire-menu-button">
                            <li id="rightarm-acquire-menu-1" class="mdl-menu__item" onclick=OnClick.RightArm.Acquire(1)>
                            </li>
                            <li id="rightarm-acquire-menu-2" class="mdl-menu__item" onclick=OnClick.RightArm.Acquire(2)>
                            </li>
                            <li id="rightarm-acquire-menu-3" class="mdl-menu__item" onclick=OnClick.RightArm.Acquire(3)>
                            </li>
                            <li id="rightarm-acquire-menu-4" class="mdl-menu__item" onclick=OnClick.RightArm.Acquire(4)>
                            </li>
                          </ul>
                        </li>
                        <input class="mdl-slider mdl-js-slider" id="rightarm-acquire-quantity-slider" type="range" min="0" max="3" value="1" onchange=OnClick.RightArm.AcquireQuantityUpdate()>
                      </ul>
                      <!-- ACTIONS END -->
                    </div>
                  </section>
                </main>
              </div>

            </div>
          </div>
        </div>
      </main>
    </div>
  </body>
  <dialog id="DIALOG_selectDemonstration" class="mdl-dialog">
    <h3 class="mdl-dialog__title">Demonstration</h3>
    <div class="mdl-dialog__content">
      <p>
        <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-1">
          <input type="radio" id="option-1" class="mdl-radio__button" name="options" value="1" checked>
          <span class="mdl-radio__label">\(\text{CaCO}_3\) with \(\text{HCl}\)
          </span>
        </label>
        <br>
        <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-2">
          <input type="radio" id="option-2" class="mdl-radio__button" name="options" value="2">
          <span class="mdl-radio__label">\(\text{CuSO}_4\) with \(\text{NaOH}\)
          </span>
        </label>
        <br>
        <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="option-2">
          <input type="radio" id="option-3" class="mdl-radio__button" name="options" value="3">
          <span class="mdl-radio__label">Titration
          </span>
        </label>
      </p>
    </div>
    <div class="mdl-dialog__actions">
      <button type="button" class="mdl-button ok" id="DIALOG_selectDemonstration_BUTTON_ok">OK
      </button>
    </div>
    <script>
      // OK button clears dialog
      document.getElementById("DIALOG_selectDemonstration_BUTTON_ok").onclick = function() {
        DIALOG_selectDemonstration.close();
      }
    </script>
  </dialog>
  <dialog id="DIALOG_confirmReset" class="mdl-dialog">
    <h3 class="mdl-dialog__title">Confirm Reset</h3>
    <div class="mdl-dialog__content">
      <p>
        Are you sure you want to reset?
      </p>
    </div>
    <div class="mdl-dialog__actions">
      <button type="button" class="mdl-button ok" id="DIALOG_confirmReset_BUTTON_ok">OK
      </button>
      <button type="button" class="mdl-button close" id="DIALOG_confirmReset_BUTTON_cancel">Cancel
      </button>
    </div>
    <script>
      document.getElementById("DIALOG_confirmReset_BUTTON_ok").onclick = function() {
        DIALOG_confirmReset.close();
        notify("Reset in process")
      }
      document.getElementById("DIALOG_confirmReset_BUTTON_cancel").onclick = function() {
        DIALOG_confirmReset.close();
      }
    </script>
  </dialog>
  <dialog id="DIALOG_inputCommand">
    <h3 class="mdl-dialog__title">Command-line</h3>
    <div class="mdl-dialog__content">
      <form action="#">
        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
          <input class="mdl-textfield__input" type="text" id="TEXTFIELD_cmd">
          <label class="mdl-textfield__label" for="cmd">Command...</label>
        </div>
      </form>
    </div>
    <div class="mdl-dialog__actions">
      <button type="button" class="mdl-button ok" id="DIALOG_inputCommand_BUTTON_execute">Execute
      </button>
    </div>
    <script>
      // OK button clears dialog
      document.getElementById("DIALOG_inputCommand_BUTTON_execute").onclick = function() {
        DIALOG_inputCommand.close();
        OnClick.Others.SendCommand(document.getElementById("TEXTFIELD_cmd").value);
      }
    </script>
  </dialog>
  <script src="config.js">
  </script>
  <script>
    // Set Camera
    var canvas = document.getElementById("CAMERA");
    var wsavc = new WSAvcPlayer(canvas, "webgl");
    wsavc.connect("ws://" + "192.168.1.3" + ":8080");
    // Select experiment function
    promptDemonstrationExperiment = function() {
      DIALOG_selectDemonstration.showModal();
    }
    // Define Snackbar shortcut function
    notify = function(notification, duration) {
      'use strict';
      window['counter'] = 0;
      var snackbarContainer = document.querySelector('#demo-toast-example');
      var data = {
        message: notification,
        timeout: duration * 1000
      };
      snackbarContainer.MaterialSnackbar.showSnackbar(data);
    }
    // Define status query function
    queryStatus = function() {
      return true;
    }
    // Define OnClick callbacks
    OnClick = {
      "Environment": {
      },
      "Others": {
      },
      "LeftArm": {
      },
      "RightArm": {
      }
    };
    OnClick.Others.SendCommand = function(command) {
      if (command == "") {
        notify("Nothing to execute")
      } else {
        notify("Executing: " + command)
        socketSend(command)
      }
    }
    OnClick.Environment.Reset = function() {
      DIALOG_confirmReset.showModal();
    }
    OnClick.Environment.SwitchWorkstate = function() {
      var checked = document.getElementById("SWITCH-workstate").checked;
      notify(checked);
    }
    OnClick.LeftArm.Hold = function(item) {
      var available = queryStatus();
      if (!available) {
        notify("Please wait for previous task");
      }
      else {
        notify("RUN: " + item, 2);
      }
    }
    OnClick.RightArm.Hold = function(item) {
      var available = queryStatus();
      if (!available) {
        notify("Please wait for previous task");
      }
      else {
        notify("RUN: " + item, 2);
      }
    }
    OnClick.LeftArm.GetChemicals = function() {
      menu = document.getElementById("leftarm-acquire-menu-1");
      menu.innerHTML=Chemicals[0]['formula'];
      menu = document.getElementById("leftarm-acquire-menu-2");
      menu.innerHTML=Chemicals[1]['formula'];
      menu = document.getElementById("leftarm-acquire-menu-3");
      menu.innerHTML=Chemicals[2]['formula'];
      menu = document.getElementById("leftarm-acquire-menu-4");
      menu.innerHTML=Chemicals[3]['formula'];
      // Display TeX
      MathJax.typeset()
    }
    OnClick.RightArm.GetChemicals = function() {
      menu = document.getElementById("rightarm-acquire-menu-1");
      menu.innerHTML=Chemicals[0]['formula'];
      menu = document.getElementById("rightarm-acquire-menu-2");
      menu.innerHTML=Chemicals[1]['formula'];
      menu = document.getElementById("rightarm-acquire-menu-3");
      menu.innerHTML=Chemicals[2]['formula'];
      menu = document.getElementById("rightarm-acquire-menu-4");
      menu.innerHTML=Chemicals[3]['formula'];
      // Display TeX
      MathJax.typeset()
    }
    OnClick.RightArm.AcquireQuantityUpdate = function() {
      var i = Number(document.getElementById("rightarm-acquire-quantity-slider").value)
      if (i == 1) {
        document.getElementById("rightarm-acquire-quantity-display").innerHTML="Amount: Little";
        document.getElementById("rightarm-acquire-menu-button").disabled = false;
      } else if (i == 2) {
        document.getElementById("rightarm-acquire-quantity-display").innerHTML="Amount: Some";
        document.getElementById("rightarm-acquire-menu-button").disabled = false;
      } else if (i == 3) {
        document.getElementById("rightarm-acquire-quantity-display").innerHTML="Amount: A lot";
        document.getElementById("rightarm-acquire-menu-button").disabled = false;
      } else if (i == 0) {
        document.getElementById("rightarm-acquire-quantity-display").innerHTML="Amount: 0";
        document.getElementById("rightarm-acquire-menu-button").disabled = true;
      }
    }
    OnClick.LeftArm.AcquireQuantityUpdate = function() {
      var i = Number(document.getElementById("leftarm-acquire-quantity-slider").value)
      if (i == 1) {
        document.getElementById("leftarm-acquire-quantity-display").innerHTML="Amount: Little";
        document.getElementById("leftarm-acquire-menu-button").disabled = false;
      } else if (i == 2) {
        document.getElementById("leftarm-acquire-quantity-display").innerHTML="Amount: Some";
        document.getElementById("leftarm-acquire-menu-button").disabled = false;
      } else if (i == 3) {
        document.getElementById("leftarm-acquire-quantity-display").innerHTML="Amount: A lot";
        document.getElementById("leftarm-acquire-menu-button").disabled = false;
      } else if (i == 0) {
        document.getElementById("leftarm-acquire-quantity-display").innerHTML="Amount: 0";
        document.getElementById("leftarm-acquire-menu-button").disabled = true;
      }
    }
    // Set onclick callbacks
    document.getElementById("SIDEBAR_ITEM_demonstration").onclick = function() {
      promptDemonstrationExperiment();
    };
    document.getElementById("SIDEBAR_ITEM_scripting").onclick = function() {
      DIALOG_inputCommand.showModal();
    };
    document.getElementById("CONTROL").style = "background:#ddd";
  </script>
</html>
